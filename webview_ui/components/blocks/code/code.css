/* css/code-block.css */

/* The main container for the code block visuals */
.block-content[data-type="code"] {
    position: relative;
    margin: var(--spacing-xs) 0;
    background-color: var(--bg-secondary);
    border-radius: 4px;
    /* We define the font here, at the top level */
    font-family: "Courier New", Courier, monospace;
    font-size: 14px;
    line-height: 1.5;
}

    /* The highlighted code container, this is what the user SEES */
    .block-content[data-type="code"] pre {
        margin: 0;
        padding: var(--spacing-m);
        white-space: pre;
        overflow-x: auto;
        min-height: calc(1.5em + 2 * var(--spacing-m)); /* line-height + vertical padding */
    }

    /* Override highlight.js theme specifics */
    .block-content[data-type="code"] .hljs {
        background: transparent !important;
        color: var(--text-primary) !important;
        padding: 0;
    }

/* The invisible textarea where the user TYPES */
.code-block-input {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    /* --- Final Fix for Cursor Misalignment --- */
    /* 1. Reset and explicitly define ALL typography from the parent */
    font: inherit; /* This is a shorthand that inherits everything: family, size, weight, line-height, etc. */
    /* 2. Force identical text wrapping and spacing behavior */
    white-space: pre;
    text-wrap: nowrap; /* CRUCIAL: Prevents any internal wrapping calculations in the textarea */
    word-break: keep-all; /* Another layer to prevent breaking */
    overflow-wrap: normal;
    letter-spacing: normal;
    word-spacing: normal;
    /* 3. Disable all font rendering optimizations that could cause width differences */
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    font-variant-ligatures: none;
    text-rendering: geometricPrecision;
    /* 4. Synchronize tab size */
    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;
    /* 5. Ensure Box Model is identical */
    padding: var(--spacing-m);
    margin: 0;
    border: none;
    outline: none !important;
    box-sizing: border-box;
    /* 6. Visual Properties */
    background: transparent;
    color: transparent;
    caret-color: var(--text-primary);
    -webkit-text-fill-color: transparent;
    /* 7. Behavior */
    resize: none;
    overflow: auto;
}

/* --- Styles for the Language Picker Popover --- */
#popover-language-picker {
    display: flex;
    flex-direction: column;
    max-height: 250px;
}

#popover-language-search {
    width: 100%;
    box-sizing: border-box;
    background-color: var(--bg-accent);
    border: 1px solid var(--border-color);
    color: var(--text-primary);
    border-radius: 4px;
    padding: var(--spacing-s);
    outline: none;
    margin-bottom: var(--spacing-s);
    flex-shrink: 0;
}

    #popover-language-search:focus {
        border-color: var(--text-accent);
    }

#popover-language-list {
    overflow-y: auto;
    flex-grow: 1;
}

.language-item {
    padding: var(--spacing-s) var(--spacing-m);
    cursor: pointer;
    border-radius: 4px;
    font-size: 14px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    transition: background-color 0.2s ease;
}

    .language-item:hover, .language-item.selected {
        background-color: var(--bg-tertiary);
    }
