<!DOCTYPE html>
<html lang="en">
 <!-- UI 文字改为英文 -->
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VeritNote</title>
    <link rel="stylesheet" href="css/style.css">

    <link rel="stylesheet" href="css/code-block.css">
    <link rel="stylesheet" href="vendor/highlight/theme.css">

</head>
<body>
    <div id="sidebar-peek-trigger"></div>

    <div class="app-container">
        <!-- 左侧边栏 -->
        <aside id="sidebar">
            <div class="sidebar-header">
                <h3>Workspace</h3>
            </div>
            <div id="workspace-tree" class="workspace-tree">
                <div class="loading-placeholder">Loading workspace...</div>
            </div>
            <div class="sidebar-footer">
                <!-- NEW: Collapse button -->
                <button id="sidebar-toggle-btn" class="sidebar-footer-btn" title="Collapse sidebar">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><line x1="9" y1="3" x2="9" y2="21"></line></svg>
                    <span>Collapse</span>
                </button>
                <button id="export-btn">Cook Workspace</button>
            </div>
        </aside>

        <!-- 主内容区域 -->
        <main id="main-content">
            <div class="editor-toolbar">
                <button id="back-to-dashboard-btn" title="Back to Dashboard">🏠</button>
                <span id="current-page-path"></span>
                <div class="mode-switcher">
                    <button id="editor-mode-btn" class="active">Edit</button>
                    <button id="preview-mode-btn">Preview</button>
                    <button id="toggle-fullscreen-btn-editor" class="icon-btn-editor" title="Toggle Fullscreen">
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"></path></svg>
                    </button>
                </div>
            </div>
            <!-- 编辑器 -->
            <div id="editor" class="editor-view">
                <!-- Blocks will be dynamically generated and inserted here by JS -->
            </div>
            <!-- 预览容器 (默认隐藏) -->
            <div id="preview" class="editor-view" style="display: none;">
                <!-- Rendered HTML will be inserted here -->
            </div>
        </main>
    </div>

    <!-- “/”命令的悬浮菜单 (默认隐藏) -->
    <div id="command-menu" class="command-menu" style="display: none;">

    </div>

    <!-- 导出遮罩层 -->
    <div id="export-overlay" class="export-overlay" style="display: none;">
        <div class="export-modal">
            <h3>Cooking</h3>
            <div class="progress-bar-container">
                <div id="progress-bar" class="progress-bar"></div>
            </div>
            <p id="export-status">Preparing Files...</p>
        </div>
    </div>

    <!-- 悬浮块操作工具栏 (默认隐藏) -->
    <div id="block-toolbar" class="block-toolbar" style="display: none;">
        <!-- Buttons will be dynamically generated by JS -->
    </div>

    <!-- 通用弹出框 (Popover)，用于链接、颜色等设置 (默认隐藏) -->
    <div id="popover" class="popover" style="display: none;">
        <div class="popover-content">
            <div id="popover-input-group">
                <input type="text" id="popover-input" placeholder="Enter a link or search for a page...">
                <button id="popover-local-file-btn" class="popover-button">Select Local File</button>
            </div>
            <div id="popover-search-results" class="popover-search-results">
                <!-- Search results will be dynamically generated by JS -->
            </div>
            <!-- 颜色选择器 -->
            <div id="popover-color-picker" class="popover-color-picker" style="display: none;">
                <!-- Preset colors will be dynamically generated by JS -->
            </div>
        </div>
    </div>

    <!-- 右键上下文菜单 -->
    <div id="context-menu" class="context-menu" style="display: none;">
        <div class="context-menu-item" data-action="newPage">New Page</div>
        <div class="context-menu-item" data-action="newFolder">New Folder</div>
        <div class="context-menu-item separator"></div>
        <div class="context-menu-item danger" data-action="delete">Delete</div>
    </div>

    <script src="js/ipc.js"></script>

    <!-- Block Definitions -->
    <script src="js/blocks/Block.js"></script>
    <script src="js/blocks/TextBlock.js"></script>
    <script src="js/blocks/ContainerBlock.js"></script>
    <script src="js/blocks/ParagraphBlock.js"></script>
    <script src="js/blocks/Heading1Block.js"></script>
    <script src="js/blocks/Heading2Block.js"></script>
    <script src="js/blocks/ImageBlock.js"></script>
    <script src="js/blocks/LinkButtonBlock.js"></script>
    <script src="js/blocks/CalloutBlock.js"></script>
    <script src="js/blocks/ColumnBlock.js"></script>
    <script src="js/blocks/ColumnsBlock.js"></script>
    <script src="js/blocks/CodeBlock.js"></script>

    <!-- Core Logic -->
    <script src="js/editor.js"></script>
    <script src="js/HistoryManager.js"></script>
    <script src="js/main.js"></script>

    <!-- Vendor Scripts -->
    <script src="vendor/highlight/highlight.min.js"></script>
</body>
</html>